function LoadPricePerPieceGrid(a){$("#lblPriceAt1000").html((.59).toFixed(2));$("#lblPriceAt2500").html((.45).toFixed(2));$("#lblPriceAt5000").html((.36).toFixed(2));$("#lblPriceAt10000").html((.32).toFixed(2));$("#lblPriceAt25000").html((.31).toFixed(2));$("#lblPriceAt50000").html((.3).toFixed(2));0!=a&&(GetPriceQuote(1E3,a),GetPriceQuote(2500,a),GetPriceQuote(5E3,a),GetPriceQuote(1E4,a),GetPriceQuote(25E3,a),GetPriceQuote(5E4,a))}
function CampaignChanged(){var a=$("#ddlTargetCampaign").val();"budget"==a?($("#numPiecesGroup").hide(750),$("#budgetGroup").show(750),$("#savedMapsGroup").hide(750)):"numpieces"==a?($("#numPiecesGroup").show(750),$("#budgetGroup").hide(750),$("#savedMapsGroup").hide(750)):"OLB"==a?($("#numPiecesGroup").hide(750),$("#budgetGroup").hide(750),$("#savedMapsGroup").hide(750)):"savedmap"==a&&($("#numPiecesGroup").hide(750),$("#budgetGroup").hide(750),$("#savedMapsGroup").show(750))}
function ImpressionsChanged(){var a=$("#ddlImpressions").val();"1"==a?($("#frequencyGroup").hide(750),$("#frequencyRow").hide(750),setTimeout(function(){$("#overviewTable").removeAttr("class");$("#overviewTable").attr("class","table table-bordered table-hover table-condensed detailedData");if("savedmap"==$("#ddlTargetCampaign").val()){var b=$("#ddlSavedMaps option:selected").text();1E3>/\(([^)]+)\)/.exec(b)[1]*a?($("#underMinimumBlock").show(),$("#campaignOverview").hide()):($("#underMinimumBlock").hide(),
$("#campaignOverview").show())}},750)):($("#frequencyGroup").show(750),$("#frequencyRow").show(750),$("#underMinimumBlock").hide(),$("#campaignOverview").show(),setTimeout(function(){$("#overviewTable").removeAttr("class");$("#overviewTable").attr("class","table table-striped table-bordered table-hover table-condensed detailedData")},750));$("#lblImpressions").html(a)}
function TemplateChanged(){var a=$("#ddlOLBTemplates").find("option:selected").attr("baseprodid");if("undefined"==typeof a){var b=$("#ddlOLBTemplates").find("option:selected").val();66==b&&(a=225);734==b&&(a=229);953==b&&(a=248);65==b&&(a=216)}b="undefined";"229"==a&&(b="4.25&quot; x 11&quot; EDDM\u2122 Postcard");"225"==a&&(b="6.25&quot; x 9&quot; EDDM\u2122 Postcard");"216"==a&&(b="8.5&quot; x 11&quot; EDDM\u2122 Postcard");"248"==a&&(b="11&quot; x 15&quot; EDDM\u2122 Flyer");$("#lblTemplate").html(b);
"undefined"==b&&LoadPricePerPieceGrid("0");LoadPricePerPieceGrid(a);setTimeout(fooCalculate,1E3)}function fooCalculate(){Calculate()}function FrequencyChanged(){var a=$("#ddlFrequency").val(),a="1"==a?"Every Week":"Every "+a+" Weeks";$("#lblFrequency").html(a)}function LaunchWeekChanged(){var a=$("#ddlLaunchWeek").val();$("#lblLaunchWeek").html("Week of "+a)}
function ClearAllTheChecks(){$("#tblRoutes tr").each(function(a,b){$(b).find("td");$(b).find('input[type="checkbox"]').prop("checked",!1)})}
function LimitReached(){var a="",b=0,c=0,d=parseFloat(NumberWithoutCommas($("#lblSelected").text())),e=parseFloat(NumberWithoutCommas($("#lblAmount").text())),a=$("#ddlTargetCampaign").length?$("#ddlTargetCampaign").val():GetParameterByName("c");"OLB"==a?b=1E4:"numpieces"==a&&(b=$("#ddlNumPieces").length?parseFloat($("#ddlNumPieces").val()):GetParameterByName("q"));c=$("#ddlBudget").length?$("#ddlBudget").val():NumberWithoutCommas(GetParameterByName("b"));return("numpieces"==a||"OLB"==a)&&d>b||"budget"==
a&&e>c?!1:!0}function GetParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(window.location.href);return null==a?"":decodeURIComponent(a[1].replace(/\+/g," "))}function NumberWithCommas(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function NumberWithoutCommas(a){a=Number(a.toString().replace(/[^0-9\.]+/g,""));return parseInt(a)}
function SavedMapCalculate(){try{var a=$("#ddlSavedMaps option:selected").text(),b=/\(([^)]+)\)/.exec(a)[1],c=$("#ddlImpressions").val(),a=b*c;1E3>a&&($("#underMinimumBlock").show(),alert("SavedMapCalculate"),$("#campaignOverview").hide());$("#lblFranchise").text($("#ddlOLBBrands").val());$("#lblLocation").text($("#ddlOLBTerritories").val());$("#lblSelected").text(NumberWithCommas(b));$("#lblImpressions").text($("#ddlImpressions").val());$("#lblTotalMailed").text(NumberWithCommas(a));$("#hidTotalMailed").val(NumberWithCommas(a));
UpdatePriceLabel(a)}catch(d){}}
function Calculate(){if("savedmap"==$("#ddlTargetCampaign").val())SavedMapCalculate();else{ClearAllTheChecks();$("#lblSelected").text(0);$("#lblAmount").text(0);$("#lblTotalMailed").text(0);$("#lblPricePerPiece").text(0);$("#hidSelected").val(0);$("#hidPctMatchAvg").val(0);$("#hidAmount").val(0);$("#hidTotalMailed").val(0);$("#hidPricePerPiece").val(0);var a=!0;$("#tblRoutes tr").each(function(b,c){$(c).find("td");var d=$(c).find('input[type="checkbox"]');a=LimitReached();"true"==GetParameterByName("r")&&
(a=!0);if(a)d.prop("checked",!0),UpdateRouteTotals();else return!1})}}function PPPTester(){$.ajax({type:"POST",dataType:"json",url:"/Resources/PrintRateQuote.ashx",data:{pid:216,qty:31083,hqty:0,sqty:0,distid:0,drops:3,zip:"28352",wd:!1,wt:!0,m:0,mt:"Percent"},success:function(a){},error:function(a){DebugHelper("Error: ",a.error)}})}
function GetPriceQuote(a,b){var c={};c.pid=b;c.qty=a;var d=$("#ddlImpressions").val(),d=$("#ddlImpressions").length?$("#ddlImpressions").val():parseInt(GetParameterByName("i"))||0;c.hqty=0;c.sqty=0;c.distid=0;c.drops=d;c.zip="28352";c.wd=!1;c.wt=!0;c.m=0;c.mt="Percent";$.ajax({type:"POST",dataType:"json",url:"/Resources/PrintRateQuote.ashx",data:c,success:function(a){null!=a&&""!=a&&(1E3<=c.qty&&2500>c.qty&&$("#lblPriceAt1000").html(a.PricePerPiece.toFixed(2)),2500<=c.qty&&5E3>c.qty&&$("#lblPriceAt2500").html(a.PricePerPiece.toFixed(2)),
5E3<=c.qty&&1E4>c.qty&&$("#lblPriceAt5000").html(a.PricePerPiece.toFixed(2)),1E4<=c.qty&&25E3>c.qty&&$("#lblPriceAt10000").html(a.PricePerPiece.toFixed(2)),25E3<=c.qty&&5E4>c.qty&&$("#lblPriceAt25000").html(a.PricePerPiece.toFixed(2)),5E4<=c.qty&&$("#lblPriceAt50000").html(a.PricePerPiece.toFixed(2)))},error:function(a){DebugHelper("Error: ",a.error)}})}
function UpdateRouteTotals(){var a=$("#ddlTargetCampaign").val();if("savedmap"==a)SavedMapCalculate();else{var b=0,c=0,d=0,e=0,e=$("#ddlImpressions").length?$("#ddlImpressions").val():parseInt(GetParameterByName("i"))||0;$("#tblRoutes tbody tr").each(function(a,e){var f=$(this).find("#lblResTotal").html(),f=parseInt(f)||0,g=$(this).find("#lblPctMatch").html(),g=parseFloat(g)||0;$(e).find("td");$(e).find('input[type="checkbox"]').is(":checked")&&(b=parseInt(b)+parseInt(f),c+=g,d+=1)});$("#lblSelected").text(NumberWithCommas(b));
$("#hidSelected").val(NumberWithCommas(b));$("#lblTotalMailed").text(NumberWithCommas(b*e));$("#hidTotalMailed").val(NumberWithCommas(b*e));c/=d;"savedmap"!=a&&($("#lblPctMatchAvg").text(c.toFixed(2)+"%"),$("#hidPctMatchAvg").val(c.toFixed(2)+"%"));UpdatePriceLabel(b*e)}}
function UpdatePriceLabel(a){var b=parseInt(a);a=0;1E3<=b&&2500>b&&(a=$("#lblPriceAt1000").html());2500<=b&&5E3>b&&(a=$("#lblPriceAt2500").html());5E3<=b&&1E4>b&&(a=$("#lblPriceAt5000").html());1E4<=b&&25E3>b&&(a=$("#lblPriceAt10000").html());25E3<=b&&5E4>b&&(a=$("#lblPriceAt25000").html());5E4<=b&&(a=$("#lblPriceAt50000").html());b*=a;a*=1;$("#lblPricePerPiece").html(a.toFixed(2));$("#hidPricePerPiece").val(a.toFixed(2));$("#lblAmount").text(NumberWithCommas(b.toFixed(2)));$("#hidAmount").val(NumberWithCommas(b.toFixed(2)))}
function DebugHelper(a,b){$("#pnlDebug").addClass("visible").removeClass("hidden");$("#debugMsg").text(a+b)}function CheckForSavedMap(){var a=$("#ddlTargetCampaign").val(),b=$("#txtBaseProductID").text();"savedmap"!=a?(LoadPricePerPieceGrid(b),Calculate()):(LoadPricePerPieceGrid(b),SavedMapCalculate())}function SetBaseProductID(){var a=$("#ddlOLBTemplates").find("option:selected").attr("baseprodid");$("#txtBaseProductID").text(a);$("#hidBaseProductID").val(a)}
function ShowHideOptions(){var a=$("#ddlTargetCampaign").val();"budget"==a?($("#numPiecesGroup").hide(500),$("#budgetGroup").show(500),$("#savedMapsGroup").hide(500)):"numpieces"==a?($("#numPiecesGroup").show(500),$("#budgetGroup").hide(500),$("#savedMapsGroup").hide(500)):"OLB"==a?($("#numPiecesGroup").hide(500),$("#budgetGroup").hide(500),$("#savedMapsGroup").hide(500)):"savedmap"==a&&($("#numPiecesGroup").hide(500),$("#budgetGroup").hide(500),$("#savedMapsGroup").show(500))};