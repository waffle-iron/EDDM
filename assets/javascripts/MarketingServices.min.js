function GetStartPosition(e, d) { var s = parseInt((e - d) / 2) + d; if ($("#hidOverrideAddOnAddressedTimes").length > 0) { var t = parseInt($("#hidOverrideAddOnAddressedTimes").val()); if (t > 0 && $("#hidOverrideAddOnAddressedProspects").length > 0) { var r = parseInt($("#hidOverrideAddOnAddressedProspects").val()), l = r / t; console.log("numberOfAddressedAddOnsInCart " + r), console.log("addressedAddOnsNumTimes " + t), console.log("Override startPostion to " + l), s = l, $("#lblSendToAddOns").html(Formatter.Commas(s)), 1 == t && NumTimesAddressedAddOnSelected("btn1Time"), 2 == t && NumTimesAddressedAddOnSelected("btn2Times"), 3 == t && NumTimesAddressedAddOnSelected("btn3Times") } } return s } function NumTimesAddressedAddOnSelected(e) { "btn1Time" == e && ($("#btn1Time").removeClass(), $("#btn1Time").addClass("btn btn-sm btn-block selected btn-shadow"), $("#btn2Times").removeClass(), $("#btn2Times").addClass("btn btn-sm btn-block"), $("#btn3Times").removeClass(), $("#btn3Times").addClass("btn btn-sm btn-block"), $("#hidNumTimesSelected").val("1"), $("#txtNumTimesSelected").val("1"), $("#lblSendNumTimes").html("1 time")), "btn2Times" == e && ($("#btn2Times").removeClass(), $("#btn2Times").addClass("btn btn-sm btn-block selected btn-shadow"), $("#btn1Time").removeClass(), $("#btn1Time").addClass("btn btn-sm btn-block"), $("#btn3Times").removeClass(), $("#btn3Times").addClass("btn btn-sm btn-block"), $("#hidNumTimesSelected").val("2"), $("#txtNumTimesSelected").val("2"), $("#lblSendNumTimes").html("2 times")), "btn3Times" == e && ($("#btn3Times").removeClass(), $("#btn3Times").addClass("btn btn-sm btn-block selected btn-shadow"), $("#btn1Time").removeClass(), $("#btn1Time").addClass("btn btn-sm btn-block"), $("#btn2Times").removeClass(), $("#btn2Times").addClass("btn btn-sm btn-block"), $("#hidNumTimesSelected").val("3"), $("#txtNumTimesSelected").val("3"), $("#lblSendNumTimes").html("3 times")), UpdateAddressedAddOnCost() } function UpdateAddressedAddOnCost() { $("#addressedMailPriceBlock").block({ message: '<h5><br /><br /><span class="fa fa-cog fa-spin"></span>&nbsp;Updating....</h5>', css: { width: "100%", height: "100%", border: "1px solid #dddddd" } }), $("#addressedPricePerPieceBlock").block({ message: '<span class="fa fa-cog fa-spin"></span>&nbsp;Updating....', css: { width: "100%", height: "100%", border: "1px solid #dddddd" } }); var e = "false", d = 6, s = 0, t = $("#hidAddressedAddOnBaseProductID").val(), r = $("#hidAddressedMailMarkUp").val(), l = $("#hidAddressedMailMarkUpType").val(), o = parseInt($("#hidSelectedAddOnAddressedList").val()), i = parseInt($("#hidNumTimesSelected").val()), a = parseInt(o * i), n = 1, c = 0, m = 0, b = $("#hidZipCode").val(), P = "Template", u = !1; "Professional Design" == P && (u = !0); var T = !1; "Template" == P && (T = !0); var p = {}; p.pid = t, p.qty = a, p.hqty = c, p.sqty = m, p.distid = s, p.drops = n, p.zip = b, p.wd = u, p.wt = T, p.m = r, p.mt = l, $.ajax({ type: "POST", dataType: "json", url: "/resources/PrintRateQuote.ashx", data: p, success: function (i) { if (null != i && "" != i) if (parseFloat(i.PricePerPiece) <= 0) $("#addressedMailPriceBlock").hide(), $("#addressedMailPriceError").show(), $("#addressedMailPriceError").removeClass(), $("#addressedMailPriceError").addClass("alert alert-danger"); else { $("#txtAddressedAddOnPricePerPiece").val(i.PricePerPiece), $("#hidAddressedAddOnPricePerPiece").val(i.PricePerPiece); var P = parseInt($("#hidSelectedAddOnAddressedList").val()), p = parseInt($("#hidNumTimesSelected").val()); $("#lblAddressedAddOnPrice").html(Formatter.Currency(P * parseFloat(i.PricePerPiece) * p)), $("#addressedPricePerPiece").html(i.FormattedPricePerPiece), setTimeout(function () { $("#addressedMailPriceBlock").unblock() }, 1e3), setTimeout(function () { $("#addressedPricePerPieceBlock").unblock() }, 1e3) } "true" == e && (console.log("*******UpdatePriceQuote for Addressed Mail AddOns***********"), console.log("UselectID: " + d), console.log("BaseProductID: " + t), console.log("totalSelected: " + o), console.log("numTimesSelected: " + p), console.log("totalToSend: " + a), console.log("holdQTY: " + c), console.log("extraCopies: " + m), console.log("distributionID: " + s), console.log("numOfDrops: " + n), console.log("zipCode: " + b), console.log("proDesign: " + u), console.log("freeTemplate: " + T), console.log("addressedMailMarkUp: " + r), console.log("addressedMailMarkUpType: " + l), console.log("msg.Price: " + i.Price), console.log("msg.FormattedTotalPrice: " + i.FormattedTotalPrice), console.log("msg.FormattedPricePerPiece: " + i.FormattedPricePerPiece), console.log("msg.PricePerPiece: " + i.PricePerPiece), console.log("*******END UpdatePriceQuote for Addressed Mail AddOns*******")) }, error: function () { setTimeout(function () { $("#addressedMailPriceBlock").unblock(), $("#addressedMailPriceBlock").hide(), $("#addressedMailPriceError").show() }, 1e3), console.log("**Ruh Roh Scooby - Error in GetAddressedMailPricePerPiece.") } }) } $(function () { var e = parseInt($("#hidAddOnAddressedProspects").val()), d = 1e3, s = "false", t = parseInt($("#hidSuggestedAddressedAddOnStartQty").val()); $("#minProspects").html(Formatter.Commas(d)), $("#maxProspects").html(Formatter.Commas(e)), $("#lblSendToAddOns").html(Formatter.Commas(t)), $("#lblSendNumTimes").html("3 times"), $("#hidNumTimesSelected").val("3"), $("#txtNumTimesSelected").val("3"), $("#addressedMailPriceError").hide(), UpdateAddressedAddOnCost(), $("#sliderControl").slider({ range: "max", min: 1e3, step: 1, max: e, value: GetStartPosition(e, d), stop: function (e, d) { UpdateAddressedAddOnCost() }, slide: function (e, d) { $("#lblSendToAddOns").html(Formatter.Commas(d.value)), $("#txtSelectedAddOnAddressedList").val(d.value), $("#hidSelectedAddOnAddressedList").val(d.value) } }), "true" == s && (console.log("addressedAddOnProspects: " + e), console.log("addressedAddOnMinQty: " + d), console.log("GetStartPosition: " + GetStartPosition(e, d)), console.log("suggestedAddressedAddOnStartQty: " + t)) }), $("a[data-action=infowindow]").click(function (e) { e.preventDefault(); var d = $("#hidProductID").val(), s = $("#hidBaseProductID").val(), t = $(this).attr("data-helpfile"), r = $(this).attr("data-title"), l = 0; $("#infoTitle").html(r), $("#infoContent").load("/Resources/ProductConfigHelp.ashx?pid=" + d + "&bpid=" + s + "&catid=" + l + "&pageref=" + t) });