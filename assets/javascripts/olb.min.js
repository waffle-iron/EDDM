function LoadPricePerPieceGrid(e) { var t = .59, l = .45, a = .36, r = .32, o = .31, i = .3; $("#lblPriceAt1000").html(t.toFixed(2)), $("#lblPriceAt2500").html(l.toFixed(2)), $("#lblPriceAt5000").html(a.toFixed(2)), $("#lblPriceAt10000").html(r.toFixed(2)), $("#lblPriceAt25000").html(o.toFixed(2)), $("#lblPriceAt50000").html(i.toFixed(2)), 0 != e && (GetPriceQuote(1e3, e), GetPriceQuote(2500, e), GetPriceQuote(5e3, e), GetPriceQuote(1e4, e), GetPriceQuote(25e3, e), GetPriceQuote(5e4, e)) } function GetPriceQuote(e, t) { var l = "false", a = {}; a.pid = t, a.qty = e; var r = $("#ddlImpressions").val(); r = $("#ddlImpressions").length ? $("#ddlImpressions").val() : parseInt(RetrieveFromQueryString.GetValue("i")) || 0, a.hqty = 0, a.sqty = 0, a.distid = 0, a.drops = r, a.zip = "28352", a.wd = !1, a.wt = !0, a.m = 0, a.mt = "Percent", $.ajax({ type: "POST", dataType: "json", url: "/Resources/PrintRateQuote.ashx", data: a, success: function (e) { null != e && "" != e && (a.qty >= 1e3 && a.qty < 2500 && $("#lblPriceAt1000").html(e.PricePerPiece.toFixed(2)), a.qty >= 2500 && a.qty < 5e3 && $("#lblPriceAt2500").html(e.PricePerPiece.toFixed(2)), a.qty >= 5e3 && a.qty < 1e4 && $("#lblPriceAt5000").html(e.PricePerPiece.toFixed(2)), a.qty >= 1e4 && a.qty < 25e3 && $("#lblPriceAt10000").html(e.PricePerPiece.toFixed(2)), a.qty >= 25e3 && a.qty < 5e4 && $("#lblPriceAt25000").html(e.PricePerPiece.toFixed(2)), a.qty >= 5e4 && $("#lblPriceAt50000").html(e.PricePerPiece.toFixed(2)), "true" == l && (console.log("--------"), console.log("msg.PricePerPiece: " + e.PricePerPiece), console.log("Quantity: " + a.qty), console.log("productID: " + t), console.log("oPostData.drops: " + a.drops), console.log("-------"))) }, error: function (e) { DebugHelper("Error: ", e.error) } }) } function Calculate() { "true" == debug && console.log("Calculate called"); var e = $("#ddlTargetCampaign").val(), t = RetrieveFromQueryString.GetValue("c"), l = "false"; if ("savedmap" == e && (l = "true"), "savedmap" == t && (l = "true"), "true" == debug && console.log("[SavedMapCalculate] isSavedMap: " + l), "true" == l) return void SavedMapCalculate(); ClearAllTheChecks(), $("#lblSelected").text(0), $("#lblAmount").text(0), $("#lblTotalMailed").text(0), $("#lblPricePerPiece").text(0), $("#hidSelected").val(0), $("#hidPctMatchAvg").val(0), $("#hidAmount").val(0), $("#hidTotalMailed").val(0), $("#hidPricePerPiece").val(0); var a = !0; $("#tblRoutes tr").each(function (e, t) { var l = ($(t).find("td"), $(t).find('input[type="checkbox"]')); return a = LimitReached(), "true" == RetrieveFromQueryString.GetValue("r") && (a = !0), a ? (l.prop("checked", !0), void UpdateRouteTotals()) : !1 }), "true" == debug } function SavedMapCalculate() { "true" == debug && console.log("SavedMapCalculate called."); try { var e = "", t = /\(([^)]+)\)/, l = 0; -1 == parseInt(window.location.href.indexOf("TargetDataMap1")) ? (e = RetrieveFromQueryString.GetValue("l") + " (" + $("#lblSelected").html() + ")", l = RetrieveFromQueryString.GetValue("i")) : (e = $("#ddlSavedMaps option:selected").text(), l = $("#ddlImpressions").val()), "true" == debug && (-1 == parseInt(window.location.href.indexOf("TargetDataMap1")) ? console.log("We are on TargetDataMap2 or 3") : console.log("We are on TargetDataMap1"), console.log("textOfMapSelected: " + e), console.log("impressions:" + l)); var a = t.exec(e), r = a[1], o = r * l; "true" == debug && (console.log("matches: " + a), console.log("count:" + r), console.log("totQty: " + o)), 1e3 > o && ($("#underMinimumBlock").show(), $("#campaignOverview").hide()), $("#lblFranchise").text($("#ddlOLBBrands").val()), $("#lblLocation").text($("#ddlOLBTerritories").val()), $("#lblSelected").text(Formatter.Commas(r)), $("#lblImpressions").text($("#ddlImpressions").val()), $("#lblTotalMailed").text(Formatter.Commas(o)), $("#hidTotalMailed").val(Formatter.Commas(o)), UpdatePriceLabel(o), $("#phForm_rowAvgMatch").hide() } catch (i) { console.log(i.message) } } function SavedMapCalculateDelay() { setTimeout(SavedMapCalculate, 2e3) } function ClearAllTheChecks() { $("#tblRoutes tr").each(function (e, t) { var l = ($(t).find("td"), $(t).find('input[type="checkbox"]')); l.prop("checked", !1) }) } function LimitReached() { var e = "", t = 0, l = 0, a = parseFloat(Formatter.RemoveCommas($("#lblSelected").text())), r = parseFloat(Formatter.RemoveCommas($("#lblAmount").text())); if (e = $("#ddlTargetCampaign").length ? $("#ddlTargetCampaign").val() : RetrieveFromQueryString.GetValue("c"), "OLB" == e ? t = 1e4 : "numpieces" == e && (t = $("#ddlNumPieces").length ? parseFloat($("#ddlNumPieces").val()) : RetrieveFromQueryString.GetValue("q")), l = $("#ddlBudget").length ? $("#ddlBudget").val() : Formatter.RemoveCommas(RetrieveFromQueryString.GetValue("b")), ("numpieces" == e || "OLB" == e) && a > t) return !1; if ("budget" == e) { if (r > l) return !1 } return !0 } function UpdateRouteTotals() { var e = $("#ddlTargetCampaign").val(); if ("savedmap" == e) return void SavedMapCalculate(); "true" == debug && console.log("UpdateRouteTotals called"); var t = 0, l = 0, a = 0, r = 0; r = $("#ddlImpressions").length ? $("#ddlImpressions").val() : parseInt(RetrieveFromQueryString.GetValue("i")) || 0, $("#tblRoutes tbody tr").each(function (e, r) { var o = $(this).find("#lblResTotal"), i = o.html(), c = parseInt(i) || 0, d = $(this).find("#lblPctMatch"), n = d.html(), s = parseFloat(n) || 0, m = ($(r).find("td"), $(r).find('input[type="checkbox"]')); m.is(":checked") && (t = parseInt(t) + parseInt(c), l += s, a += 1) }), $("#lblSelected").text(Formatter.Commas(t)), $("#hidSelected").val(Formatter.Commas(t)), $("#lblTotalMailed").text(Formatter.Commas(t * r)), $("#hidTotalMailed").val(Formatter.Commas(t * r)), l /= a, "savedmap" != e && ($("#lblPctMatchAvg").text(l.toFixed(2) + "%"), $("#hidPctMatchAvg").val(l.toFixed(2) + "%")), UpdatePriceLabel(t * r) } function UpdatePriceLabel(e) { var t = parseInt(e), l = 0; t >= 1e3 && 2500 > t && (l = $("#lblPriceAt1000").html()), t >= 2500 && 5e3 > t && (l = $("#lblPriceAt2500").html()), t >= 5e3 && 1e4 > t && (l = $("#lblPriceAt5000").html()), t >= 1e4 && 25e3 > t && (l = $("#lblPriceAt10000").html()), t >= 25e3 && 5e4 > t && (l = $("#lblPriceAt25000").html()), t >= 5e4 && (l = $("#lblPriceAt50000").html()); var a = l * t, r = 1 * l; $("#lblPricePerPiece").html(r.toFixed(2)), $("#hidPricePerPiece").val(r.toFixed(2)), $("#lblAmount").text(Formatter.Commas(a.toFixed(2))), $("#hidAmount").val(Formatter.Commas(a.toFixed(2))) }